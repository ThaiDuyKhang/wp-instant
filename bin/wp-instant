#!/usr/bin/env bash

set -e

COMMAND=$1
PROJECT_NAME=$2

if [[ "$COMMAND" != "new" || -z "$PROJECT_NAME" ]]; then
  echo "Usage:"
  echo "  wp-instant new <project-name>"
  exit 1
fi

TARGET_DIR=$(pwd)/$PROJECT_NAME

if [[ -d "$TARGET_DIR" ]]; then
  echo "Error: Directory '$PROJECT_NAME' already exists."
  exit 1
fi

echo "Creating WordPress project: $PROJECT_NAME"

mkdir "$TARGET_DIR"
cp -R "$(dirname "$0")/../template/." "$TARGET_DIR"

cd "$TARGET_DIR"

chmod +x setup.sh

./setup.sh

echo "WordPress project '$PROJECT_NAME' created successfully."
